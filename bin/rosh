#!/usr/bin/env ruby

def setup_logging
  if ARGV.include? '--log'
    Rosh::Logger.logging_enabled = true
    Rosh::CLI.logging_enabled = true if Rosh.const_defined?(:CLI)
    Rosh::Shell.logging_enabled = true
    Rosh::Host.logging_enabled = true
    Rosh::FileSystem.logging_enabled = true
    Rosh::Command.logging_enabled = true
  else
    Rosh::Logger.logging_enabled = false
    Rosh::CLI.logging_enabled = false if Rosh.const_defined?(:CLI)
    Rosh::Shell.logging_enabled = false
  end
end

if ARGV.include? '--irb'
  require_relative '../lib/rosh'
  setup_logging
  ARGV.delete '--irb'
  ARGV.delete '--log'

  require 'irb'
  IRB.setup '../lib/rosh'

  # eval Rosh.config if Rosh.config

  IRB.start
else
  require_relative '../lib/rosh/cli'

  setup_logging
  Rosh::CLI.run
end
